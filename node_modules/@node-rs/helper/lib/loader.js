"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.loadBinding = void 0;
var tslib_1 = require("tslib");
var fs_1 = require("fs");
var os_1 = require("os");
var path_1 = require("path");
var SupportedPlatforms = new Set(['darwin', 'win32', 'linux']);
function loadBinding(dirname, filename) {
    if (filename === void 0) { filename = 'index'; }
    var platformName = os_1.platform();
    if (!SupportedPlatforms.has(platformName)) {
        throw new TypeError("Unsupported platform: " + platformName + ", only support " + tslib_1.__spread(SupportedPlatforms.values()).join(', '));
    }
    var bindingFilePath = path_1.join(dirname, filename + "." + platformName + ".node");
    if (platformName === 'linux') {
        try {
            return require(bindingFilePath);
        }
        catch (_a) {
            return require(path_1.join(dirname, filename + ".linux-musl.node"));
        }
    }
    if (!fs_1.existsSync(bindingFilePath)) {
        throw new TypeError("Could not find binding file on path " + bindingFilePath);
    }
    return require(bindingFilePath);
}
exports.loadBinding = loadBinding;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibG9hZGVyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vc3JjL2xvYWRlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEseUJBQStCO0FBQy9CLHlCQUE2QjtBQUM3Qiw2QkFBMkI7QUFFM0IsSUFBTSxrQkFBa0IsR0FBRyxJQUFJLEdBQUcsQ0FBa0IsQ0FBQyxRQUFRLEVBQUUsT0FBTyxFQUFFLE9BQU8sQ0FBQyxDQUFDLENBQUE7QUFFakYsU0FBZ0IsV0FBVyxDQUFDLE9BQWUsRUFBRSxRQUFrQjtJQUFsQix5QkFBQSxFQUFBLGtCQUFrQjtJQUM3RCxJQUFNLFlBQVksR0FBRyxhQUFRLEVBQUUsQ0FBQTtJQUMvQixJQUFJLENBQUMsa0JBQWtCLENBQUMsR0FBRyxDQUFDLFlBQVksQ0FBQyxFQUFFO1FBQ3pDLE1BQU0sSUFBSSxTQUFTLENBQ2pCLDJCQUF5QixZQUFZLHVCQUFrQixpQkFBSSxrQkFBa0IsQ0FBQyxNQUFNLEVBQUUsRUFBRSxJQUFJLENBQUMsSUFBSSxDQUFHLENBQ3JHLENBQUE7S0FDRjtJQUVELElBQU0sZUFBZSxHQUFHLFdBQUksQ0FBQyxPQUFPLEVBQUssUUFBUSxTQUFJLFlBQVksVUFBTyxDQUFDLENBQUE7SUFFekUsSUFBSSxZQUFZLEtBQUssT0FBTyxFQUFFO1FBQzVCLElBQUk7WUFDRixPQUFPLE9BQU8sQ0FBQyxlQUFlLENBQUMsQ0FBQTtTQUNoQztRQUFDLFdBQU07WUFDTixPQUFPLE9BQU8sQ0FBQyxXQUFJLENBQUMsT0FBTyxFQUFLLFFBQVEscUJBQWtCLENBQUMsQ0FBQyxDQUFBO1NBQzdEO0tBQ0Y7SUFFRCxJQUFJLENBQUMsZUFBVSxDQUFDLGVBQWUsQ0FBQyxFQUFFO1FBQ2hDLE1BQU0sSUFBSSxTQUFTLENBQUMseUNBQXVDLGVBQWlCLENBQUMsQ0FBQTtLQUM5RTtJQUVELE9BQU8sT0FBTyxDQUFDLGVBQWUsQ0FBQyxDQUFBO0FBQ2pDLENBQUM7QUF2QkQsa0NBdUJDIn0=